% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/svregrp.R
\name{svregrp_Gibbs}
\alias{svregrp_Gibbs}
\title{Gibbs sampling of the grouped household effect model}
\usage{
svregrp_Gibbs(
  Y_star,
  x_covs,
  z_covs,
  i_ind,
  sh_ind,
  hit_ind,
  max_steps,
  cor_step_size,
  corr_vs_diag = FALSE,
  calcu_DIC = TRUE,
  burn_in = 1,
  verbose = TRUE,
  init_mean_coeffs = NULL,
  init_corr_coeffs = NULL,
  init_sigma2_e = NULL,
  init_sigma2_u = NULL,
  init_sigma2_v = NULL
)
}
\arguments{
\item{Y_star}{A NN * 1 matrix containing continuous responses.}

\item{x_covs}{A NN * p matrix containing covariates for the mean model.}

\item{z_covs}{A NN * q matrix containing covariates for the correlation model.}

\item{i_ind}{A vector containing indices for individual.}

\item{sh_ind}{A vector containing indices for super-household.}

\item{hit_ind}{A vector containing indices for unique household.}

\item{max_steps}{Length of MCMC chains to be drawn.}

\item{cor_step_size}{A vector length q specifying step sizes for q coefficients
of correlation model.}

\item{corr_vs_diag}{Whether set the grouped household effects to be independent,
default value is FALSE.}

\item{calcu_DIC}{Whether to calculate DIC values, default value is TRUE.}

\item{burn_in}{Burn in size for MCMC, default value is 1.}

\item{verbose}{Whether print information in each iteration, default value is TRUE.}

\item{init_mean_coeffs}{Optional initial values for mean coefficients.}

\item{init_corr_coeffs}{Optional initial values for correlation coefficients.}

\item{init_sigma2_e}{Optional initial value for error variance.}

\item{init_sigma2_u}{Optional initial value for individual random effect variance.}

\item{init_sigma2_v}{Optional initial value for household random effect variance.}
}
\value{
A list containing:
\item{params_mcmc_obj}{MCMC chains of model parameters}
\item{U_all}{Individual random effects}
\item{VH_all}{Household random effects}
\item{DIC}{Deviance Information Criterion}
}
\description{
This function takes response, multilevel indices as input and
returns MCMC sample chains of model parameters and latent variables.
}
\examples{
\donttest{
# Load example household panel data
data_path <- system.file("extdata", "test.rda", package = "mvregrp")
load(data_path)

# Set MCMC parameters
nsample <- 1000
burn_in <- 500

# Run grouped random effect probit model
result <- svregrp_Gibbs(
  Y_star = as.matrix(ysim), # Outcome variable
  x_covs = as.matrix(x_covs), # Mean model design matrix
  z_covs = as.matrix(corr_covs), # Correlation model design matrix
  i_ind = i_ind, # Individual indices
  sh_ind = sh_ind, # Super-household indices
  hit_ind = hit_ind, # Household indices
  max_steps = nsample, # Total MCMC iterations
  cor_step_size = c(rep(0.01, ncol(corr_covs) - 3), 0.001), # MH jump step sizes for correlation parameters, needs pre-tunning
  corr_vs_diag = FALSE, # Use full correlation structure
  verbose = FALSE # Suppress progress output
)

# Extract posterior samples (after burn-in)
chains <- as.data.frame(result$params_mcmc_obj)[(burn_in + 1):nsample, ]
posterior_means <- colMeans(chains)
print(round(posterior_means, 3))
}
}
